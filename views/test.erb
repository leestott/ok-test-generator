test = {
	"name": "<%= @test_name == "" ? "test" : @test_name %>",
	"points": <%= @tests.points == "" ? 1 : @tests.points %>,
	"hidden": <%= @tests.visible ? "False" : "True" %>,
	"suites": [ <% for suite in @tests.suites %>
		{
			"cases": [ <% for test_case in suite.cases %>
				{
					"code": r"""<% i = 0; test_case.code.each_line do |line| %>
					<%= (i != 0 && line =~ /^(\t| {2,4})/) ? "..." : ">>>" %> <%= line.delete_suffix("\n") %><% i += 1; end %><% i = 0; test_case.output.each_line do |line| %>
					<%= line.delete_suffix("\n") %><% i += 1; end %>
					""",
					"hidden": <%= test_case.hidden ? "True" : "False" %>,
					"locked": <%= test_case.locked ? "True" : "False" %>,
				}, <% end %>
			],
			"scored": <%= suite.scored ? "True" : "False" %>,
			"setup": "",
			"teardown": "",
			"type": "doctest"
		}, <% end %>
	]
}